{"ast":null,"code":"import { MongoClient } from \"mongodb\";\nimport nextConnect from \"next-connect\";\nconst client = new MongoClient(\"mongodb+srv://Admin:Admin@learning-zc5e1.mongodb.net/test?retryWrites=true&w=majority\", {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n});\n\nasync function withDatabase(req, res, next) {\n  if (!client.isConnected()) await client.connect();\n  req.dbClient = client;\n  req.db = client.db(\"test\");\n  return next();\n}\n\nconst middleware = nextConnect();\nmiddleware.use(withDatabase);\nexport default middleware;","map":{"version":3,"sources":["C:/Users/Bartosz/Desktop/nextTutorial/middleware/withDatabase.js"],"names":["MongoClient","nextConnect","client","useNewUrlParser","useUnifiedTopology","withDatabase","req","res","next","isConnected","connect","dbClient","db","middleware","use"],"mappings":"AAAA,SAASA,WAAT,QAA4B,SAA5B;AACA,OAAOC,WAAP,MAAwB,cAAxB;AAEA,MAAMC,MAAM,GAAG,IAAIF,WAAJ,CACX,uFADW,EAEX;AACIG,EAAAA,eAAe,EAAE,IADrB;AAEIC,EAAAA,kBAAkB,EAAE;AAFxB,CAFW,CAAf;;AAQA,eAAeC,YAAf,CAA4BC,GAA5B,EAAiCC,GAAjC,EAAsCC,IAAtC,EAA4C;AACxC,MAAI,CAACN,MAAM,CAACO,WAAP,EAAL,EAA2B,MAAMP,MAAM,CAACQ,OAAP,EAAN;AAC3BJ,EAAAA,GAAG,CAACK,QAAJ,GAAeT,MAAf;AACAI,EAAAA,GAAG,CAACM,EAAJ,GAASV,MAAM,CAACU,EAAP,CAAU,MAAV,CAAT;AACA,SAAOJ,IAAI,EAAX;AACH;;AAED,MAAMK,UAAU,GAAGZ,WAAW,EAA9B;AAEAY,UAAU,CAACC,GAAX,CAAeT,YAAf;AAEA,eAAeQ,UAAf","sourcesContent":["import { MongoClient } from \"mongodb\";\r\nimport nextConnect from \"next-connect\";\r\n\r\nconst client = new MongoClient(\r\n    \"mongodb+srv://Admin:Admin@learning-zc5e1.mongodb.net/test?retryWrites=true&w=majority\",\r\n    {\r\n        useNewUrlParser: true,\r\n        useUnifiedTopology: true,\r\n    }\r\n);\r\n\r\nasync function withDatabase(req, res, next) {\r\n    if (!client.isConnected()) await client.connect();\r\n    req.dbClient = client;\r\n    req.db = client.db(\"test\");\r\n    return next();\r\n}\r\n\r\nconst middleware = nextConnect();\r\n\r\nmiddleware.use(withDatabase);\r\n\r\nexport default middleware;\r\n"]},"metadata":{},"sourceType":"module"}